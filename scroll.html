<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Process Bar</title>
</head>

<body>
	<style>
		* {box-sizing: border-box;}
		body{margin:0;background-color: gray;}
		/* img{width:100%;height:auto;} */

		.scroll-wrap {position: relative;display: flex;background-color: black;}
		.scroll-wrap img {position: relative;top:0;left:0;}
	</style>
<div style="height:1500px"></div>
	<div class="scroll-wrap" data-scrollHeight="200">
		<img src="./img1.jpg" alt="" height="200">
	</div>
	<div style="height:1000px"></div>
	<div style="position:fixed;top:0;bottom:0;width:100%;"></div>


	<script>
		let scrollWrap = document.querySelectorAll('.scroll-wrap');

		window.addEventListener('load', scrollBar)
		window.addEventListener('scroll', scrollBar)

		
		function scrollBar(e) {

			for (let i = 0; i < scrollWrap.length; i++) {
				let ele = scrollWrap[i];
				let eleHeight = ele.clientHeight;
				let clientRect = ele.getBoundingClientRect();
				let viewportHeight = window.innerHeight; // 스크롤바 높이 포함
				// let docH = document.documentElement.clientHeight; // 스크롤바 높이 불포함
				let pageYOffset = window.pageYOffset;
				let startPos = pageYOffset + clientRect.top - viewportHeight;
				let endPos = startPos + viewportHeight
				let ratio = 100 / (endPos - startPos)
				let movePer = (pageYOffset - startPos) * ratio
				let movePx = viewportHeight * movePer / 100;

				let test2 = endPos - startPos
				// ele.style.opacity = move + '%'
				// ele.style.transform = 'translateY(-' + move + 'px)'

				console.group('s')
				
				console.log(
					'eleHeight', eleHeight
					+'\n'+
					'viewportHeight', viewportHeight
					+'\n'+
					'clientRect.top', clientRect.top
					+'\n'+
					'pageYOffset', pageYOffset
					+'\n'+
					'startPos', startPos
					+'\n'+
					'endPos', endPos
					+'\n'+
					'ratio', ratio
					+'\n'+
					'movePer', movePer + '%'
					+'\n'+
					'movePx', movePx + 'px'
					+'\n'+
					'test1', pageYOffset + clientRect.top - viewportHeight + viewportHeight - pageYOffset + clientRect.top - viewportHeight
					+'\n'+
					'test2', test2
				)
				// console.log(docH)

				console.groupEnd('e')
			}



			



			
			// let maxScroll = parseInt(window.getComputedStyle(ele.children[0]).height) - ele.clientHeight + parseInt(window.getComputedStyle(ele).paddingTop) + parseInt(window.getComputedStyle(ele).paddingBottom);
			// let scrollPos = ele.scrollTop;
			// let perScroll = (scrollPos / maxScroll) * 100;

			// ele.style.top = perScroll + '%';
			
		}
	</script>
</body>

</html>